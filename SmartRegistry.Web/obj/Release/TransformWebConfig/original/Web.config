<?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  https://go.microsoft.com/fwlink/?LinkId=301880
  -->
<configuration>
	<configSections>
		<!-- Others sections -->
		<section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" />
    <section name="saml2" type="SAML2.Config.Saml2Section, SAML2" />
	</configSections>
	
	<connectionStrings>
    <clear />
    <add name="DefaultConnectionOld" connectionString="Provider=SAOLEDB.11;DSN=tt;UID=dba;PWD=tt" />

    <!--  <add name="DefaultConnection" connectionString="Server = hxehost:39013; UserID = XSA_ADMIN; Password = S@Phana42" />-->
    <add name="DefaultConnection" connectionString="Server = 10.90.11.11:39015; UserID = SYSTEM; Password = Orak391db" />
       <add name="DefaultConnection4" connectionString="Server = 172.23.205.132:39013; UserID = XSA_ADMIN; Password = S@Phana42" />


  
  </connectionStrings>
  <appSettings>
  
    <add key="AESKey" value="0F1EDBA46A432FD35D776658318E573C"/>
    <add key="AES4" value="E320E0EC793090E0"/>
    
 
    <add key="webpages:Version" value="3.0.0.0" />
    <add key="webpages:Enabled" value="false" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="SSODestination" value="https://eauth-test.egov.bg/SingleSignOnService" />
    <add key="SSOIssuer" value="https://eauth-test.egov.bg/profilebe/saml2/service-provider-metadata/mock-idp" />

    <!--Email data-->
      <add key="mailPort" value="80" />
      <add key="mailHost" value="mail.egov-box.bg" />
      <add key="mailUser" value="noreply@egov-box.bg" />
      <add key="mailPass" value="0rakN0replay#@!" />
      <add key="mailFrom" value="noreply@egov-box.bg" />
      <add key="mailName" value="Registration" />
    
    <!--eAuthenticator start-->
    <add key="bg.gov.eAuth.version" value="2" />
    <add key="bg.gov.eAuth.providerId" value="2.16.100.1.1.1.1.13" />
    <add key="bg.gov.eAuth.extService" value="2.16.100.1.1.1.1.13.1.1.1" />
    <add key="bg.gov.eAuth.extProvider" value="2.16.100.1.1.1.1.13" />
    <!--v2-->
    <add key="bg.gov.eAuth.2.loginUrl" value="Redirect" />
    <add key="bg.gov.eAuth.2.returnUrl" value="https://localhost:44389/Authentication/AuthenticateCertificate" />
    <add key="bg.gov.eAuth.2.targetUrl" value="https://eauth-test.egov.bg/SingleSignOnService" />
    <add key="bg.gov.eAuth.2.providerName" value="ИСЦИПР" />

    <add key="WarningLabel" value="ТЕСТОВА" />
    
  </appSettings>

  <log4net>

    Define some output appenders
    <appender name="trace" type="log4net.Appender.TraceAppender, log4net">
      <layout type="log4net.Layout.PatternLayout,log4net">
        <param name="ConversionPattern" value="%d{ABSOLUTE} %-5p %c{1}:%L - %m%n" />
      </layout>
    </appender>

    <appender name="console" type="log4net.Appender.ConsoleAppender, log4net">
      <layout type="log4net.Layout.PatternLayout,log4net">
        <param name="ConversionPattern" value="%d{ABSOLUTE} %-5p %c{1}:%L - %m%n" />
      </layout>
    </appender>

    <appender name="rollingFile" type="log4net.Appender.RollingFileAppender,log4net">

      <param name="File" value="SmartRegistry_log.txt" />
      <param name="AppendToFile" value="false" />
      <param name="RollingStyle" value="Date" />
      <param name="DatePattern" value="yyyy.MM.dd" />
      <param name="StaticLogFileName" value="true" />

      <layout type="log4net.Layout.PatternLayout,log4net">
        <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
      </layout>
    </appender>

    <appender name="NHibernateLog" type="log4net.Appender.RollingFileAppender,log4net">

      <param name="File" value="nHibernate_log.txt" />
      <param name="AppendToFile" value="false" />
      <param name="RollingStyle" value="Date" />
      <param name="DatePattern" value="yyyy.MM.dd" />
      <param name="StaticLogFileName" value="true" />

      <layout type="log4net.Layout.PatternLayout,log4net">
        <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
      </layout>
    </appender>

    <appender name="SqlLog" type="log4net.Appender.RollingFileAppender,log4net">

      <param name="File" value="Sql_log.txt" />
      <param name="AppendToFile" value="false" />
      <param name="RollingStyle" value="Date" />
      <param name="DatePattern" value="yyyy.MM.dd" />
      <param name="StaticLogFileName" value="true" />

      <layout type="log4net.Layout.PatternLayout,log4net">
        <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
      </layout>
    </appender>

    Setup the root category, add the appenders and set the default priority
    <root>
      <priority value="ERROR" />
      <appender-ref ref="rollingFile" />
    </root>

    <logger name="NHibernate">
      <level value="ERROR" />
      <appender-ref ref="NHibernateLog" />
    </logger>

    <logger name="NHibernate.SQL">
      <level value="DEBUG" />
      <appender-ref ref="SqlLog" />
    </logger>

  </log4net>


  <system.web>
    <compilation debug="true" targetFramework="4.7.2" />
    <httpRuntime targetFramework="4.7.2" />
    <globalization culture="auto" uiCulture="auto" enableClientBasedCulture="true" />
   
  </system.web>
  <system.webServer>
    <handlers>
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <remove name="OPTIONSVerbHandler" />
      <remove name="TRACEVerbHandler" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="*" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
	<modules>
		<add name="DbContextHttpModule" type="SmartRegistry.CommonWeb.SmartDbContextHttpModule" />
	</modules>
	  <!-- TODO to be removed - for tests to allow Cross Site -->
	  <httpProtocol>
		  <customHeaders>
			  <add name="Access-Control-Allow-Origin" value="*" />
		  </customHeaders>
	  </httpProtocol>
  </system.webServer>


  <saml2>
    <allowedAudienceUris>
      <audience uri="https://edelivery-test.egov.bg/metadata/info/saml" />
    </allowedAudienceUris>
    <commonDomainCookie enabled="false">
    </commonDomainCookie>
    <serviceProvider id="urn:edelivery-test.egov.bg" server="https://edelivery-test.egov.bg">
      <signingCertificate findValue="  " storeLocation="LocalMachine" storeName="My" x509FindType="FindByThumbprint" />
        <endpoints>
          <endpoint type="SignOn" localPath="/authentication/redirect" redirectUrl="~/authentication/redirect" />
          <endpoint type="Logout" localPath="/authentication/logout" redirectUrl="~/authentication/logout" />
          <endpoint type="Metadata" localPath="/metadata/info/saml" redirectUrl="~/metadata/info/saml" />
        </endpoints>
      </serviceProvider>
    <identityProviders>
      <add name="eAuth 2.0" id="https://eauth-test.egov.bg">
        <endpoints>
          <endpoint type="Metadata" url="https://eauth-test.egov.bg/tfauthbe/saml/metadata/idp" binding="Post" />
        </endpoints>
        <certificateValidations>
          <add type="SAML2.Specification.SelfIssuedCertificateSpecification, SAML2" />
        </certificateValidations>
      </add>
    </identityProviders>
    <metadata lifetime="0.00:15:00">
      <organization name="EDelivery" displayName="EDelivery" url="https://edelivery.egov.bg" />
      <contacts>
        <contact type="Administrative" company="Ciela Norma AD" givenName="Veselin" surName="Petrov" email="" />
        </contacts>
      <requestedAttributes>
        <add name="urn:egov:bg:eauth:2.0:attributes:personIdentifier" isRequired="true" />
        <add name="urn:egov:bg:eauth:2.0:attributes:personName" isRequired="true" />
        <add name="urn:egov:bg:eauth:2.0:attributes:email" isRequired="true" />
        <add name="urn:egov:bg:eauth:2.0:attributes:phone" />
        <add name="urn:egov:bg:eauth:2.0:attributes:dateOfBirth" />
      </requestedAttributes>
    </metadata>
  </saml2>
  
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Antlr3.Runtime" publicKeyToken="eb42632606e9261f" />
        <bindingRedirect oldVersion="0.0.0.0-3.5.0.2" newVersion="3.5.0.2" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Optimization" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-1.1.0.0" newVersion="1.1.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" />
        <bindingRedirect oldVersion="0.0.0.0-13.0.0.0" newVersion="13.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-5.2.7.0" newVersion="5.2.7.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-7.0.0.0" newVersion="7.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Owin" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.ValueTuple" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.3.0" newVersion="4.0.3.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Threading.Tasks.Extensions" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.1" newVersion="4.2.0.1" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Bcl.AsyncInterfaces" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-7.0.0.0" newVersion="7.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Buffers" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.3.0" newVersion="4.0.3.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="NHibernate" publicKeyToken="aa95f207798dfdb4" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.3.0.0" newVersion="5.3.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:1659;1699;1701" />
      <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=\&quot;Web\&quot; /optionInfer+" />
    </compilers>
  </system.codedom>
  <system.net>
    <mailSettings>
      <smtp from="noreply@egov-box.bg">
        <network host="mail.egov-box.bg" userName="noreply@egov-box.bg" password="0rakN0replay#@!" defaultCredentials="false" />
      </smtp>
    </mailSettings>
  </system.net>
</configuration>