(function(){"use strict";var e={340:function(e,t,r){var a=r(8935),s=r(9018),i=r.n(s),n=r(2196),l=r.n(n),o=r(6166),u=r.n(o),c=r(9483),d=r(5011),m=r(8262),p=r(3266),h=r(6016),f=r.n(h),b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("form",{staticClass:"form"},[r("button",{staticStyle:{display:"none"},on:{click:function(t){return t.preventDefault(),e.submitForm({filter:!0})}}}),e.hasFilterData?r("div",[r("div",{staticClass:"row mb-4 filter"},[e._l(e.filterData,(function(t){return r("div",{key:t.name,class:"col-"+t.col},["checkbox"!==t.type?r("label",{staticClass:"form-label",attrs:{for:t.name}},[e._v(" "+e._s(t.label)+" ")]):e._e(),"password"===t.type?[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.value,expression:"filter.value",modifiers:{trim:!0}}],staticClass:"form-control input-password",attrs:{id:t.name,type:t.type,name:t.name,title:t.label,required:t.required,disabled:!t.enabled},domProps:{value:t.value},on:{input:function(r){r.target.composing||e.$set(t,"value",r.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._m(0,!0)]:e._e(),"number"===t.type?[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.value,expression:"filter.value",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{id:t.name,type:t.type,name:t.name,title:t.label,min:t.min,max:t.max,step:t.step,required:t.required,disabled:!t.enabled},domProps:{value:t.value},on:{input:function(r){r.target.composing||e.$set(t,"value",r.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]:e._e(),"date"===t.type?[r("datetime",{attrs:{format:"dd MMM yyyy","input-class":"form-control",type:t.type,name:t.name,title:t.label,"input-id":t.name,"value-zone":"Europe/Sofia",autocomplete:"off",auto:!0,required:t.required,disabled:!t.enabled},model:{value:t.value,callback:function(r){e.$set(t,"value","string"===typeof r?r.trim():r)},expression:"filter.value"}})]:e._e(),"datetime"===t.type?[r("datetime",{attrs:{format:"dd MMM yyyy HH:mm a","input-class":"form-control",type:t.type,name:t.name,title:t.label,"input-id":t.name,"value-zone":"Europe/Sofia",autocomplete:"off",auto:!0,required:t.required,disabled:!t.enabled},model:{value:t.value,callback:function(r){e.$set(t,"value","string"===typeof r?r.trim():r)},expression:"filter.value"}})]:e._e(),"paragraph"===t.type?[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.value,expression:"filter.value",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{id:t.name,type:t.type,name:t.name,title:t.label,readOnly:"true",required:t.required,disabled:!t.enabled},domProps:{value:t.value},on:{input:function(r){r.target.composing||e.$set(t,"value",r.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]:e._e(),"text"===t.type?["checkbox"===t.type?r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"filter.value"}],staticClass:"form-control",attrs:{id:t.name,name:t.name,title:t.label,required:t.required,disabled:!t.enabled,type:"checkbox"},domProps:{checked:Array.isArray(t.value)?e._i(t.value,null)>-1:t.value},on:{change:function(r){var a=t.value,s=r.target,i=!!s.checked;if(Array.isArray(a)){var n=null,l=e._i(a,n);s.checked?l<0&&e.$set(t,"value",a.concat([n])):l>-1&&e.$set(t,"value",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(t,"value",i)}}}):"radio"===t.type?r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"filter.value"}],staticClass:"form-control",attrs:{id:t.name,name:t.name,title:t.label,required:t.required,disabled:!t.enabled,type:"radio"},domProps:{checked:e._q(t.value,null)},on:{change:function(r){return e.$set(t,"value",null)}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"filter.value"}],staticClass:"form-control",attrs:{id:t.name,name:t.name,title:t.label,required:t.required,disabled:!t.enabled,type:t.type},domProps:{value:t.value},on:{input:function(r){r.target.composing||e.$set(t,"value",r.target.value)}}})]:e._e(),"textarea"===t.type?[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"filter.value"}],staticClass:"form-control",attrs:{id:t.name,type:t.type,name:t.name,title:t.label,rows:t.rows,cols:t.cols,required:t.required,disabled:!t.enabled},domProps:{value:t.value},on:{input:function(r){r.target.composing||e.$set(t,"value",r.target.value)}}})]:e._e(),"checkbox"===t.type?[r("b-form-checkbox",{attrs:{id:t.name,name:t.name,disabled:!t.enabled},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"filter.value"}},[e._v(" "+e._s(t.label)+" ")])]:e._e(),"select"===t.type?[r("multiselect",{attrs:{options:t.options,searchable:!0,"show-labels":!0,label:"label","track-by":"label",required:t.required,disabled:!t.enabled},model:{value:t.selectedValue,callback:function(r){e.$set(t,"selectedValue","string"===typeof r?r.trim():r)},expression:"filter.selectedValue"}})]:e._e(),"selectsearch"===t.type?[r("multiselect",{attrs:{options:t.options,label:"label","track-by":"label","preserve-search":!0,"reset-after":!1,"group-values":"groupOptions","group-label":"label",required:t.required,disabled:!t.enabled},model:{value:t.value,callback:function(r){e.$set(t,"value","string"===typeof r?r.trim():r)},expression:"filter.value"}})]:e._e(),"multiselect"===t.type?[r("multiselect",{attrs:{options:t.options,multiple:!0,"close-on-select":!1,"preserve-search":!0,label:"label","track-by":"label","reset-after":!1,"group-values":"groupOptions","group-label":"label","group-select":!0,"hide-selected":!0,required:t.required,disabled:!t.enabled},model:{value:t.selectedValues,callback:function(r){e.$set(t,"selectedValues",r)},expression:"filter.selectedValues"}})]:e._e()],2)})),r("div",{staticClass:"col-md-2"},[r("div",{staticClass:"mb-3"},[r("label",{staticClass:"form-label"},[e._v("   ")]),r("button",{staticClass:"form-control btn btn-primary",attrs:{type:"submit"},on:{click:function(t){return t.preventDefault(),e.submitForm({filter:!0})}}},[e._v(" Филтрирай ")])])]),e.hasActiveFilters?r("div",{staticClass:"col-md-2 mb-3"},[r("label",{staticClass:"form-label"},[e._v("   ")]),r("button",{staticClass:"form-control btn btn-danger",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.resetFilters.apply(null,arguments)}}},[e._v(" Изчисти ")])]):e._e()],2)]):e._e()]),r("div",{staticClass:"row mb-4 sort"},[r("span",{staticClass:"col-1 mr-4"},[e._v("Показване: ")]),r("b-select",{staticClass:"col-2 px-3",attrs:{options:e.totalPagesOptions},on:{change:e.setPerPage},model:{value:e.perPage,callback:function(t){e.perPage=t},expression:"perPage"}})],1),e.hasTableData?r("div",[r("b-table",{attrs:{items:e.items,fields:e.fields,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"sort-icon-left":"","current-page":e.currentPage,"no-sort-reset":"",responsive:"sm"},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"sort-changed":e.setSorting},scopedSlots:e._u([{key:"cell()",fn:function(t){return[r("div",{domProps:{innerHTML:e._s(t.value)}})]}},{key:"cell(Actions)",fn:function(t){return e._l(t.item.Actions,(function(t){return r("a",{key:t.key,class:e.btnClass(t.key),staticStyle:{margin:"0 1px"},attrs:{href:t.url,"data-toggle":"tooltip","data-placement":"top",title:t.name}},[r("i",{class:e.btnIconClass(t.key)})])}))}}],null,!1,1999501356)}),r("b-pagination-nav",{staticClass:"my-0",attrs:{"number-of-pages":e.totalPages,"base-url":"#","prev-text":"Предишна","next-text":"Следваща",size:"sm"},on:{change:e.setPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1):e._e()])},y=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a",{staticClass:"show-pass",attrs:{href:"javascript:void(0)"}},[r("i",{staticClass:"fa fa-eye-slash"})])}];const v={initCurrentPage:1,initPerPage:5,initSortBy:null,initSortDesc:!1};var g={name:"App",data(){return{initFilterData:{},tableData:{},filterData:{},filterDataCopy:{},tableDataColumns:[],sortBy:v.initSortBy,sortDesc:v.initSortDesc,totalPages:null,perPage:v.initPerPage,currentPage:v.initCurrentPage,rows:null,totalPagesOptions:[{value:5,text:"5"},{value:10,text:"10"},{value:15,text:"15"},{value:20,text:"20"}],filtered:!1}},computed:{hasTableData(){return 0!==Object.keys(this.tableData).length},hasFilterData(){return 0!==this.tableData.length},hasActiveFilters(){return!this.$lodash.isEqual(this.filterData,this.initFilterData)},isPerPageInit(){return this.perPage==v.initPerPage},isCurrentPageInit(){return this.currentPage==v.initCurrentPage},isSortByInit(){return this.sortBy==v.initSortBy},isSortDescInit(){return this.sortDesc==v.initSortDesc},fields(){return 0!==this.tableData.length?this.tableData.columns:[]},items(){if(0!==this.tableData.length){const e=this.tableData.rows.map((e=>({objectId:e.objectId,...(()=>{const t=e.cells.map((e=>"actions"!==e.key?{[e.key]:e.text}:{Actions:e.actions}));return Object.assign({},...t)})()})));return e}return[]},query(){return this.$lodash.pickBy({currentPage:this.isCurrentPageInit?null:Number(this.currentPage),perPage:this.isPerPageInit?null:Number(this.perPage),sortBy:this.isSortByInit?null:this.sortBy,sort:this.isSortByInit?null:!0===this.sortDesc?"desc":"asc"})}},watch:{"$route.query":{handler(e,t){this.currentPage=Number(e.currentPage||v.initCurrentPage),this.perPage=Number(e.perPage||v.initPerPage),this.sortBy=e.sortBy||v.initSortBy,this.sortDesc="desc"===e.sort||v.initSortDesc,this.$lodash.isEqual(e,t)||(this.filtered?this.submitForm({filter:!0}):this.submitForm())},deep:!0}},mounted(){this.getData()},methods:{async getData(){try{const{data:e}=await this.axios.get(window.jsonData.jsonUrlFilter);if(this.filterData=e,this.initFilterData=this.$lodash.cloneDeep(e),this.filterDataCopy=this.$lodash.cloneDeep(this.filterData),console.log("filterData",this.filterData),this.$lodash.isEmpty(this.$route.query)){const e=window.jsonData,{data:t}=await this.axios.get(e.jsonUrlTable);this.tableData=t,this.tableDataColumns=t.columns.filter((e=>!0===e.sortable)).map((e=>e.key)),this.totalPages=t.totalPages,this.currentPage=Number(this.$route.query.currentPage||t.currentPage),this.perPage=Number(this.$route.query.perPage||t.numberOfRowsPerPage),this.rows=t.rows.length,this.sortBy=this.$route.query.sortBy||t.orderColumn,this.sortDesc="desc"===this.$route.query.sort||"desc"===t.orderDirection}else this.currentPage=Number(this.$route.query.currentPage||v.initCurrentPage),this.perPage=Number(this.$route.query.perPage||v.initPerPage),this.sortBy=this.$route.query.sortBy||v.initSortBy,this.sortDesc="desc"===this.$route.query.sort||v.initSortDesc,this.submitForm()}catch(e){console.error("Error loading filter data and table data","\n",e)}},async submitForm({filter:e=!1}={}){try{const t={currentPage:Number(this.currentPage),numberOfRowsPerPage:Number(this.perPage),orderColumn:this.$lodash.isEmpty(this.$route.query.sortBy)?null:this.$route.query.sortBy,orderDirection:this.$lodash.isEmpty(this.$route.query.sortBy)?null:this.$lodash.isEmpty(this.$route.query.sort)?"asc":this.$route.query.sort};let r=[];e?(t.currentPage=v.initCurrentPage,r=this.$lodash.cloneDeep(this.filterData).concat(t),this.filterDataCopy=this.$lodash.cloneDeep(this.filterData),this.currentPage=v.initCurrentPage):r=this.$lodash.cloneDeep(this.filterDataCopy).concat(t),console.log("submitted with:",r);const a=window.jsonData,{data:s}=await this.axios.post(a.jsonUrlTable,r);this.filtered=!1,console.log("returned:",s),this.tableData=s,this.tableDataColumns=s.columns.filter((e=>!0===e.sortable)).map((e=>e.key)),this.totalPages=s.totalPages,this.currentPage=s.currentPage,this.perPage=s.numberOfRowsPerPage,this.rows=s.rows.length,this.sortBy=s.orderColumn||null,this.sortDesc=null!=s.orderDirection?"desc"===s.orderDirection:null}catch(t){console.error("Error submitting filter:","\n",t)}},btnClass(e){switch(e){case"view":return"btn btn-success";case"history":return"btn btn-info";case"edit":return"btn btn-warning ";case"delete":return"btn btn-danger";case"rights":return"btn btn-rights";case"resetPassword":return"btn btn-reset-password";case"stateTransition":return"btn btn-rights";case"registerState":return"btn btn-info";case"webService":return"btn btn-success"}},btnIconClass(e){switch(e){case"view":return"mdi mdi-eye-outline";case"history":return"mdi mdi-progress-clock";case"edit":return"dripicons-pencil";case"delete":return"dripicons-trash";case"rights":return"mdi mdi-key-outline";case"resetPassword":return"mdi mdi-lock-reset";case"registerState":return"dripicons-checklist";case"stateTransition":return"dripicons-media-shuffle";case"webService":return"dripicons-web"}},filterColClass(e){return`col-md-${e}`},setQuery(){this.$router.push({query:this.query}).catch((()=>{}))},setPage(e){this.currentPage=Number(e),this.setQuery()},setPerPage(e){this.perPage=Number(e),this.setQuery()},setSorting(e){this.sortBy=e.sortBy,this.sortDesc=e.sortDesc,this.setQuery()},resetFilters(){this.currentPage=v.initCurrentPage,this.filterData=this.$lodash.cloneDeep(this.initFilterData),this.filtered=!0,this.setQuery()}}},P=g,D=r(1001),w=(0,D.Z)(P,b,y,!1,null,null,null),$=w.exports,C=(r(44),r(2809));a["default"].use(C.Z);const x=[],k=new C.Z({mode:"history",routes:x});var q=k;a["default"].use(c.Z,u()),a["default"].use(i(),{name:"$lodash",lodash:l()}),a["default"].use(d.Datetime),a["default"].use(m.XG7),a["default"].use(p.A7),a["default"].component("datetime",d.Datetime),a["default"].component("Multiselect",f()),a["default"].config.productionTip=!1,new a["default"]({router:q,render:e=>e($)}).$mount("#app")}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,function(){r.amdO={}}(),function(){var e=[];r.O=function(t,a,s,i){if(!a){var n=1/0;for(c=0;c<e.length;c++){a=e[c][0],s=e[c][1],i=e[c][2];for(var l=!0,o=0;o<a.length;o++)(!1&i||n>=i)&&Object.keys(r.O).every((function(e){return r.O[e](a[o])}))?a.splice(o--,1):(l=!1,i<n&&(n=i));if(l){e.splice(c--,1);var u=s();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[a,s,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,i,n=a[0],l=a[1],o=a[2],u=0;if(n.some((function(t){return 0!==e[t]}))){for(s in l)r.o(l,s)&&(r.m[s]=l[s]);if(o)var c=o(r)}for(t&&t(a);u<n.length;u++)i=n[u],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},a=self["webpackChunktable"]=self["webpackChunktable"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=r.O(void 0,[998],(function(){return r(340)}));a=r.O(a)})();
//# sourceMappingURL=app.js.map